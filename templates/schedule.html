{% extends "base.html" %}
{% block title %}Schedule Reminders{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='schedule.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='reminder.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='timing.css') }}">

<div class="schedule-container">
  <h1 class="page-title">Schedule for - Medicine</h1>

  <!-- Pill pack -->
  <section class="pill-pack-section">
    <h2 class="section-title">How many days is your pill pack for?</h2>
    <div class="pill-pack-options" id="pillPackOptions" role="group" aria-label="Pill pack duration options">
      <button type="button" class="option" data-days="7" aria-pressed="false">7 Days</button>
      <button type="button" class="option" data-days="15" aria-pressed="false">15 Days</button>
      <button type="button" class="option" data-days="21" aria-pressed="false">21 Days</button>
      <button type="button" class="option" data-days="30" aria-pressed="false">30 Days</button>
      <button type="button" class="option" data-days="45" aria-pressed="false">45 Days</button>
      <button type="button" class="option" data-days="60" aria-pressed="false">60 Days</button>
    </div>

    <div class="custom-days-section">
      <label for="customDaysInput">Or enter a custom number of days:</label>
      <input id="customDaysInput" type="number" min="1" placeholder="Enter days" aria-label="Custom pill pack duration in days">
    </div>

    <div class="total-quantity-section">
      <label for="totalQuantityInput">Total Quantity of pill pack</label>
      <input id="totalQuantityInput" type="number" min="1" placeholder="Total doses (e.g. 28)" aria-label="Total quantity of pill pack">
      <div id="totalQuantityError" class="input-error" aria-live="polite" style="display:none;"></div>
    </div>

    <h2 class="section-title">What Date is the first day of your pill pack?</h2>
    <div class="date-picker">
      <input id="startDate" type="text" value="" placeholder="DD-MM-YYYY" aria-label="Start date in DD-MM-YYYY format">
      <span class="calendar-icon">ðŸ“…</span>
    </div>
  </section>

  <!-- Weekly schedule -->
  <section class="weekly-schedule-section">
    <h2 class="section-title">Weekly Schedule</h2>
    <div class="days-of-week" role="group" aria-labelledby="schedule-heading">
      <button class="day" data-day="SUN" aria-pressed="false">S</button>
      <button class="day" data-day="MON" aria-pressed="false">M</button>
      <button class="day" data-day="TUE" aria-pressed="false">T</button>
      <button class="day" data-day="WED" aria-pressed="false">W</button>
      <button class="day" data-day="THU" aria-pressed="false">T</button>
      <button class="day" data-day="FRI" aria-pressed="false">F</button>
      <button class="day" data-day="SAT" aria-pressed="false">S</button>
    </div>
    <div id="schedule-error" class="error-message" aria-live="polite"></div>

    <div class="timing">
      <div id="timeInputsContainer" role="group" aria-label="Time entries in HH:MM format, IST timezone">
        <!-- Time input rows will be added here -->
      </div>
      <div id="times-error" class="error-message" aria-live="polite" aria-atomic="true"></div>
      
        <div class="timing-info-card">
        <div class="timing-info-header" role="region" aria-labelledby="timing-info-heading">
          <h2 id="timing-info-heading" class="timing-heading">Timing Info</h2>
          <p id="timing-info-note" class="timing-note">All times are recorded in Indian Standard Time (IST)</p>
        </div>

        <div class="timing-controls" role="group" aria-labelledby="timing-info-heading">
          <div class="form-group timing-control-item">
          <label for="time-input">Time (IST):</label>
          <input type="time" id="time-input" name="time" step="60" required aria-describedby="timing-info-note">
          <span id="time-error" class="error-message" role="alert" aria-live="polite"></span>
          </div>

          <div class="form-group timing-control-item">
          <label for="frequency-select">Frequency</label>
          <select id="frequency-select" name="frequency" aria-describedby="timing-info-note">
            <option value="once">Once</option>
            <option value="once_a_day" selected>Once a day</option>
            <option value="twice_a_day">Twice a day</option>
            <option value="every_x_hours">Every X hours</option>
          </select>
          </div>

          <div class="form-group timing-control-item" id="every-x-hours-group" aria-hidden="true">
          <label for="every-x-hours-input">Hours (X):</label>
          <input type="number" id="every-x-hours-input" name="every_x_hours" min="1" max="24" placeholder="X" inputmode="numeric">
          <span id="hours-error" class="error-message" role="alert" aria-live="polite"></span>
          </div>
        </div>

        <form id="schedule-form" novalidate>
          <div class="form-controls">
            <fieldset class="reminder-settings">
              <legend>ðŸ”” REMINDER SETTINGS</legend>
                    
              <!-- Light-blue section with Enable Reminder and Snooze -->
              <div class="reminder-header-section">
                <div class="form-group reminder-toggle">
                  <input type="checkbox" id="enable-reminder-checkbox" aria-label="Enable reminder notifications">
                  <label for="enable-reminder-checkbox">Enable Reminder</label>
                </div>
                <div class="form-group">
                  <label for="snooze-select">Snooze every</label>
                  <select id="snooze-select" aria-label="Snooze interval in minutes">
                    <option value="5">5 min</option>
                    <option value="10" selected>10 min</option>
                    <option value="15">15 min</option>
                    <option value="30">30 min</option>
                    <option value="60">60 min</option>
                  </select>
                </div>
              </div>

              <!-- Notification type section below -->
              <div id="reminder-options">
                <div class="form-group notification-type">
                  <span>Notification Type:</span>
                  <input type="checkbox" id="notify-browser-checkbox" aria-label="Enable browser notifications">
                  <label for="notify-browser-checkbox">Browser</label>
                  <input type="checkbox" id="notify-email-checkbox" aria-label="Enable email notifications">
                  <label for="notify-email-checkbox">Email</label>
                </div>
              </div>
            </fieldset>
          </div>

          <div class="form-actions">
            <button type="submit" id="save-schedule-btn">Save Schedule</button>
          </div>
          <p id="success-message" class="success-message" aria-live="polite"></p>
          <p id="storage-error" class="error-message" role="alert" aria-live="polite"></p>
        </form>

        </div>
    </div>
  </section>

  <!-- bottom nav -->
  <div class="bottom-nav">
    <button id="backBtn" class="btn-nav btn-secondary">Back</button>
    <button id="nextBtnSched" class="btn-nav btn-primary">Next</button>
  </div>
</div>

<script src="{{ url_for('static', filename='schedule.js') }}" defer></script>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='reminder.js') }}" defer></script>
<script src="{{ url_for('static', filename='timing.js') }}" defer></script>
{% endblock %}
